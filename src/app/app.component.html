<h2>Coller rapport espionnage</h2>

<mat-card>
	<mat-card-header
		class="text-card"
		matRipple
		[matRippleUnbounded]="false"
		(click)="state = state === 'closed' ? 'opened' : 'closed'"
	>
		<button mat-icon-button>
			<mat-icon [class.icon-closed]="state === 'closed'">
				expand_less
			</mat-icon>
		</button>
	</mat-card-header>
	<div class="animated-content" [@slide]="state">
		<mat-card-content>
			<mat-form-field>
				<textarea [(ngModel)]="rawData" matInput rows="15"></textarea>
			</mat-form-field>
		</mat-card-content>
		<mat-card-actions>
			<button mat-button color="accent" (click)="process(true)">
				Process
			</button>
			<button
				*ngIf="spyReports.length"
				mat-button
				color="accent"
				(click)="process(false)"
			>
				Add
			</button>
		</mat-card-actions>
	</div>
</mat-card>

<mat-card>
	<mat-card-header>
		<button mat-button (click)="resetFilter()">Reset</button>
		<button mat-button (click)="clearFleet()">Clear Fleets</button>
		<button mat-button (click)="clearDefense()">Clear Defense</button>
		<button mat-button (click)="clearBoth()">Clear Both</button>
	</mat-card-header>
	<mat-card-content>
		<table mat-table [dataSource]="dataSource" matSort>
			<!--- Note that these columns can be defined in any order.
				  The actual rendered columns are set as a property on the row definition" -->

			<!-- Index Column -->
			<ng-container matColumnDef="index">
				<th mat-header-cell *matHeaderCellDef mat-sort-header>
					No.
				</th>
				<td mat-cell *matCellDef="let element; let i = index">
					{{ i + 1 }}
				</td>
			</ng-container>

			<!-- Resources Column -->
			<ng-container matColumnDef="resources">
				<th mat-header-cell *matHeaderCellDef mat-sort-header>
					Resources
				</th>
				<td mat-cell *matCellDef="let element">
					{{ element.resources | number }}
				</td>
			</ng-container>

			<!-- Flottes Column -->
			<ng-container matColumnDef="flottes">
				<th mat-header-cell *matHeaderCellDef mat-sort-header>
					Flottes
				</th>
				<td mat-cell *matCellDef="let element">
					{{ element.flottes }}
				</td>
			</ng-container>

			<!-- Defenses Column -->
			<ng-container matColumnDef="defenses">
				<th mat-header-cell *matHeaderCellDef mat-sort-header>
					Defenses
				</th>
				<td mat-cell *matCellDef="let element">
					{{ element.defenses }}
				</td>
			</ng-container>

			<!-- Cargo Column -->
			<ng-container matColumnDef="noCargo">
				<th mat-header-cell *matHeaderCellDef mat-sort-header>
					Cargos
				</th>
				<td mat-cell *matCellDef="let element">
					{{ element.noCargo }}
				</td>
			</ng-container>

			<!-- Coords Column -->
			<ng-container matColumnDef="coordinates">
				<th mat-header-cell *matHeaderCellDef mat-sort-header>
					Coord.
				</th>
				<td mat-cell *matCellDef="let element">
					<span (click)="navigate(element)" class="coords">
						{{ element.coordinates.toString() }}
					</span>
				</td>
			</ng-container>

			<tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
			<tr
				mat-row
				*matRowDef="let row; columns: displayedColumns"
				[class.focused]="lastElementClicked === row"
			></tr>
		</table>
	</mat-card-content>
</mat-card>
